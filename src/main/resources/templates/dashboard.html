<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Dashboard</title>
</head>
<body>

<h2>User Dashboard</h2>

<!-- Flash message -->
<div th:if="${message}">
    <p th:text="${message}"></p>
</div>

<!-- Basic user info -->
<div th:if="${session.loggedInUser != null}">
    <p>
        Welcome,
        <strong th:text="${session.loggedInUser.customer.username}">Username</strong>
    </p>
</div>

<hr>

<h3>Buyer Functions</h3>
<ul>
    <li><a th:href="@{/products}">Browse Products</a></li>
    <li><a th:href="@{/cart}">My Cart</a></li>
    <li><a th:href="@{/orders/my}">My Orders</a></li>
</ul>

<hr>

<h3>Seller Section</h3>

<!-- Case 1: No seller record yet (user can apply) -->
<div th:if="${session.loggedInUser.seller == null}">
    <p>Current status: <strong>Not a seller yet</strong></p>
    <form th:action="@{/seller/apply}" method="post">
        <button type="submit">Apply to become a seller</button>
    </form>
</div>

<!-- Case 2: Seller exists and is pending -->
<div th:if="${session.loggedInUser.seller != null
             and session.loggedInUser.seller.status == 'PENDING'}">
    <p>Current status: <strong>Waiting for admin approval...</strong></p>
    <p>Your application is under review.</p>
</div>

<!-- Case 3: Seller approved -->
<div th:if="${session.loggedInUser.seller != null
             and session.loggedInUser.seller.status == 'APPROVED'}">
    <p>Current status: <strong>Seller (Approved)</strong></p>

    <ul>
        <li><a th:href="@{/seller/products}">Manage My Products</a></li>
        <li><a th:href="@{/seller/products/new}">Add New Product</a></li>
        <li><a th:href="@{/seller/orders}">View Orders for My Products</a></li>
    </ul>
</div>

<!-- Case 4: Seller application rejected -->
<div th:if="${session.loggedInUser.seller != null
             and session.loggedInUser.seller.status == 'REJECTED'}">
    <p>Current status: <strong>Seller application rejected</strong></p>
    <p>You can submit a new application if needed.</p>
    <form th:action="@{/seller/apply}" method="post">
        <button type="submit">Apply again</button>
    </form>
</div>

<hr>

<a th:href="@{/logout}">Logout</a>

</body>
</html>
